const jwt = require('express-jwt');

const { JWT } = require('../config');

const { secret } = JWT;

module.exports = {
  /**
   * Express request handlers that verify if a valid token exists in request.
   *
   * The token can be passed as an `Authorization` header or a query parameter named `token`.
   *
   * Decoded payload will then be available in `req.auth`.
   *
   * @example
   *
   * // routes/articles/index.js
   *
   * const articlesController = require('./controller');
   * const { auth } = require('../middleware');
   *
   * router.get('/articles', auth.required, articlesController.getArticles);
   */
  auth: {
    required: jwt({
      secret,
      requestProperty: 'auth',
    }),
    optional: jwt({
      secret,
      requestProperty: 'auth',
      credentialsRequired: false,
    }),
  },
};
